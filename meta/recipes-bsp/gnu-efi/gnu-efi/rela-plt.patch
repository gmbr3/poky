From 280015264847d379976448c3c222425cb405ca6c Mon Sep 17 00:00:00 2001
From: Callum Farmer <gmbr3@opensuse.org>
Date: Tue, 7 Mar 2023 21:25:35 +0000
Subject: [PATCH] fix rela.plt

---
 gnuefi/elf_aarch64_efi.lds  | 2 +-
 gnuefi/elf_arm_efi.lds      | 2 +-
 gnuefi/elf_ia32_efi.lds     | 2 +-
 gnuefi/elf_ia64_efi.lds     | 2 +-
 gnuefi/elf_mips64el_efi.lds | 2 +-
 gnuefi/elf_riscv64_efi.lds  | 2 +-
 gnuefi/elf_x86_64_efi.lds   | 2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/gnuefi/elf_aarch64_efi.lds b/gnuefi/elf_aarch64_efi.lds
index 475a736..44d8ed2 100644
--- a/gnuefi/elf_aarch64_efi.lds
+++ b/gnuefi/elf_aarch64_efi.lds
@@ -59,10 +59,10 @@ SECTIONS
     *(.rela.text*)
     *(.rela.data*)
     *(.rela.got)
-    *(.rela.plt)
     *(.rela.dyn)
     *(.rela.stab)
   }
+  .rela.plt : { *(.rela.plt) }
   . = ALIGN(512);
   _edata = .;
   _data_size = . - _data;
diff --git a/gnuefi/elf_arm_efi.lds b/gnuefi/elf_arm_efi.lds
index c38ef71..d332572 100644
--- a/gnuefi/elf_arm_efi.lds
+++ b/gnuefi/elf_arm_efi.lds
@@ -46,10 +46,10 @@ SECTIONS
     *(.rel.text*)
     *(.rel.data*)
     *(.rel.got)
-    *(.rel.plt)
     *(.rel.dyn)
     *(.rel.stab)
   }
+  .rel.plt : { *(.rel.plt) }
   _edata = .;
   _data_size = . - _etext;
 
diff --git a/gnuefi/elf_ia32_efi.lds b/gnuefi/elf_ia32_efi.lds
index d800b6c..85065e6 100644
--- a/gnuefi/elf_ia32_efi.lds
+++ b/gnuefi/elf_ia32_efi.lds
@@ -61,7 +61,6 @@ SECTIONS
     *(.rel.sdata*)
     *(.rel.data*)
     *(.rel.got)
-    *(.rel.plt)
     *(.rel.dyn)
     *(.rel.stab)
     *(.data.rel.ro.local)
@@ -69,6 +68,7 @@ SECTIONS
     *(.data.rel.ro)
     *(.data.rel*)
   }
+  .rel.plt : { *(.rel.plt) }
   _edata = .;
   _data_size = . - _etext;
   . = ALIGN(4096);
diff --git a/gnuefi/elf_ia64_efi.lds b/gnuefi/elf_ia64_efi.lds
index 6ab462a..9a9436b 100644
--- a/gnuefi/elf_ia64_efi.lds
+++ b/gnuefi/elf_ia64_efi.lds
@@ -58,12 +58,12 @@ SECTIONS
     *(.rela.sdata*)
     *(.rela.data*)
     *(.rela.got)
-    *(.rela.plt)
     *(.rela.dyn)
     *(.rela.gnu.linkonce.d*)
     *(.rela.stab)
     *(.rela.ctors)
   }
+  .rela.plt : { *(.rela.plt) }
   _edata = .;
   _data_size = . - _etext;
   . = ALIGN(4096);
diff --git a/gnuefi/elf_mips64el_efi.lds b/gnuefi/elf_mips64el_efi.lds
index 4272830..cc2a842 100644
--- a/gnuefi/elf_mips64el_efi.lds
+++ b/gnuefi/elf_mips64el_efi.lds
@@ -46,10 +46,10 @@ SECTIONS
     *(.rel.text*)
     *(.rel.data*)
     *(.rel.got)
-    *(.rel.plt)
     *(.rel.dyn)
     *(.rel.stab)
   }
+  .rel.plt : { *(.rel.plt) }
   _edata = .;
   _data_size = . - _etext;
 
diff --git a/gnuefi/elf_riscv64_efi.lds b/gnuefi/elf_riscv64_efi.lds
index e6eec43..ea63954 100644
--- a/gnuefi/elf_riscv64_efi.lds
+++ b/gnuefi/elf_riscv64_efi.lds
@@ -49,10 +49,10 @@ SECTIONS {
     *(.rela.text*)
     *(.rela.data*)
     *(.rela.got)
-    *(.rela.plt)
     *(.rela.dyn)
     *(.rela.stab)
   }
+.rela.plt : { *(.rela.plt) }
 	. = ALIGN(512);
 	_edata = .;
 	_data_size = . - _data;
diff --git a/gnuefi/elf_x86_64_efi.lds b/gnuefi/elf_x86_64_efi.lds
index 45acff3..cc2fabc 100644
--- a/gnuefi/elf_x86_64_efi.lds
+++ b/gnuefi/elf_x86_64_efi.lds
@@ -58,10 +58,10 @@ SECTIONS
     *(.rela.text*)
     *(.rela.data*)
     *(.rela.got)
-    *(.rela.plt)
     *(.rela.dyn)
     *(.rela.stab)
   }
+  .rela.plt : { *(.rela.plt) }
   . = ALIGN(4096);
   .dynsym   : { *(.dynsym) }
   . = ALIGN(4096);
-- 
2.31.1

